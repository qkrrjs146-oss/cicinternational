<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>CIC ‚Äî Center for International Clarity (Student View)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root { --maxw: 1100px; --accent:#b22222; --nav-bg:#f8f8f8; --muted:#666; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial; margin:0; color:#111; background:#fbfbfb;}
    .top-banner { background:var(--accent); color:white; padding:12px; text-align:center; font-weight:700; letter-spacing:0.5px; font-size:15px;}
    header { background:#222; color:#fff; padding:12px 16px; position:sticky; top:0; z-index:40; display:flex; align-items:center; gap:12px; justify-content:space-between; }
    .brand { display:flex; gap:12px; align-items:center; }
    .logo { font-size:20px; font-weight:800; letter-spacing:1px; }
    .subtitle { font-size:13px; opacity:0.95; color:#e7e7e7; }
    .container { max-width:var(--maxw); margin:16px auto; padding:0 16px; }
    .lead { background:#fff9f9; border-left:6px solid #ffd1d1; padding:14px; margin-bottom:14px; border-radius:6px; }

    /* Tabs */
    .tabs { background:var(--nav-bg); border-bottom:1px solid #e6e6e6; display:flex; gap:18px; padding:10px 16px; align-items:center; position:sticky; top:64px; z-index:30; }
    .tab { cursor:pointer; padding:8px 10px; border-radius:4px; font-weight:700; color:#333; }
    .tab.active { background:white; box-shadow:0 1px 3px rgba(0,0,0,0.06); border:1px solid #e6e6e6; }

    /* Layout */
    .pane { display:none; padding-top:18px; }
    .pane.active { display:block; }

    /* Articles */
    .articles { display:grid; grid-template-columns:1fr; gap:14px; margin-top:10px; }
    @media(min-width:720px){ .articles{ grid-template-columns:1fr 1fr;} }

    article.card { background:white; padding:14px; border-radius:8px; box-shadow:0 1px 4px rgba(0,0,0,0.04); border:1px solid #eee; }
    article h2 { font-size:18px; margin:0 0 8px; cursor:pointer; text-decoration:underline; color:#123a7a; }
    .meta { font-size:13px; color:#666; margin-bottom:12px; }
    img.thumb { width:100%; max-height:240px; object-fit:cover; border-radius:6px; aspect-ratio:16/9; background:#eee; cursor:pointer; }

    /* Modal */
    .modal-backdrop { position:fixed; inset:0; background:rgba(0,0,0,0.65); display:none; align-items:center; justify-content:center; z-index:200; }
    .modal { background:white; width:min(900px,95%); max-height:90vh; overflow:auto; border-radius:8px; padding:18px; box-shadow:0 6px 30px rgba(0,0,0,0.35); }
    .modal h2 { margin-top:0; }

    /* Info display */
    .info-display { background:white; padding:18px; border-radius:8px; border:1px solid #eee; }
  </style>
</head>
<body>
  <div class="top-banner">CIC ‚Äî Center for International Clarity</div>

  <header>
    <div class="brand">
      <div>
        <div class="logo">Anti-Fake News Site</div>
        <div class="subtitle">Global News Platform</div>
      </div>
    </div>
    <div style="min-width:1px;"></div>
  </header>
  <!-- Tabs -->
  <div class="tabs">
    <div class="tab active" data-tab="news">News</div>
    <div class="tab" data-tab="institution">Information of Institution</div>
    <div class="tab" data-tab="antifake">Anti-Fake News System</div>
    <div class="tab" data-tab="report">Report</div>
  </div>

  <div class="container">
    <div class="lead">
      <strong>Note:</strong> This platform is run by a non-profit organization, Transparent Press Campaign. 
      This is a student version ‚Äî editing features are disabled.
    </div>

    <!-- =======================
         NEWS PANE
         ======================= -->
    <div id="pane-news" class="pane active">
      <div id="articles" class="articles"></div>
    </div>

    <!-- =======================
         INSTITUTION PAGE
         ======================= -->
    <div id="pane-institution" class="pane">
      <h2>Institution Information</h2>
      <div id="institution-display" class="info-display"></div>
    </div>

    <!-- =======================
         ANTI-FAKE PAGE
         ======================= -->
    <div id="pane-antifake" class="pane">
      <h2>Anti-Fake News System</h2>
      <div id="antifake-display" class="info-display"></div>
    </div>

    <!-- =======================
         REPORT PAGE
         ======================= -->
    <div id="pane-report" class="pane">
      <h2>Report</h2>
      <div id="report-display" class="info-display"></div>
    </div>
  </div>

  <footer>
    <div>Created for classroom media literacy. This is a student-safe static version.</div>
  </footer>

  <!-- Modal -->
  <div id="modal-backdrop" class="modal-backdrop">
    <div class="modal">
      <button id="modal-close" style="float:right;background:#eee;border:none;border-radius:6px;padding:6px;cursor:pointer;">‚úï Close</button>
      <div id="modal-content"></div>
    </div>
  </div>
<script>
/* ============================================
   üîµ TAB SWITCHING
   ============================================ */
document.querySelectorAll('.tab').forEach(tab => {
  tab.addEventListener('click', () => {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    tab.classList.add('active');

    const target = tab.dataset.tab;
    document.querySelectorAll('.pane').forEach(p => p.classList.remove('active'));
    document.getElementById("pane-" + target).classList.add('active');

    window.scrollTo({ top: 0, behavior: 'smooth' });
  });
});

/* ============================================
   üîµ JSON ÌååÏùº Ï£ºÏÜå (GitHub RAW URL)
   ============================================ */
const JSON_URL =
  "https://raw.githubusercontent.com/cicinternational/cicinternational/main/mocknews_export_2025-12-01%20(5).json";

/* ============================================
   üîµ Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞
   ============================================ */
let articles = [];
let pages = {};  // institution, antifake, report

async function loadData() {
  try {
    const response = await fetch(JSON_URL);
    const data = await response.json();

    // JSON Íµ¨Ï°∞: { articles: [...], pages: {...} }
    articles = data.articles || [];
    pages = data.pages || {};

    renderArticles();
    renderPages();

  } catch (err) {
    console.error("JSON load error:", err);
    document.getElementById("articles").innerHTML =
      "<p style='color:red;'>Failed to load data.</p>";
  }
}

/* ============================================
   üîµ Ïú†Ìã∏ Ìï®Ïàò
   ============================================ */
function escapeHtml(text) {
  if (!text) return "";
  return text.replace(/[&<>"']/g, m => ({
    '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'
  }[m]));
}

/* ============================================
   üîµ ARTICLE LIST Î†åÎçîÎßÅ
   ============================================ */
function renderArticles() {
  const container = document.getElementById("articles");
  container.innerHTML = "";

  if (articles.length === 0) {
    container.innerHTML = "<p>No articles available.</p>";
    return;
  }

  const sorted = articles.slice().sort((a,b) => b.savedAt - a.savedAt);

  sorted.forEach(a => {
    const card = document.createElement("article");
    card.className = "card";

    const thumb = a.image
      ? `<img class="thumb" src="${a.image}" data-id="${a.id}">`
      : "";

    card.innerHTML = `
      ${thumb}
      <h2 data-id="${a.id}">${escapeHtml(a.title)}</h2>
      <div class="meta">
        ${escapeHtml(a.author || "Unknown")} ¬∑ 
        ${escapeHtml(a.category || "")} ¬∑
        ${new Date(a.savedAt).toLocaleString()}
      </div>
      <p>${escapeHtml(a.body).slice(0,400)}${a.body.length>400 ? "..." : ""}</p>
    `;

    container.appendChild(card);
  });

  document.querySelectorAll(".thumb").forEach(img =>
    img.addEventListener("click", e => openArticle(img.dataset.id))
  );
  document.querySelectorAll("h2[data-id]").forEach(h =>
    h.addEventListener("click", e => openArticle(h.dataset.id))
  );
}

/* ============================================
   üîµ MODAL ‚Äì Í∏∞ÏÇ¨ Î≥∏Î¨∏ Ïó¥Í∏∞
   ============================================ */
function openArticle(id) {
  const article = articles.find(a => a.id === id);
  if (!article) return;

  const modal = document.getElementById("modal-backdrop");
  const content = document.getElementById("modal-content");

  content.innerHTML = `
    <h2>${escapeHtml(article.title)}</h2>
    <div class="meta">
      ${escapeHtml(article.author || "Unknown")} ¬∑
      ${escapeHtml(article.category)} ¬∑
      ${new Date(article.savedAt).toLocaleString()}
    </div>
    ${article.image ? `<img src="${article.image}" style="width:100%;border-radius:8px;margin-bottom:14px;">` : ""}
    <div style="white-space:pre-wrap;">${escapeHtml(article.body)}</div>
  `;

  modal.style.display = "flex";
  document.body.style.overflow = "hidden";
}

/* Îã´Í∏∞ Ïù¥Î≤§Ìä∏ */
document.getElementById("modal-close").addEventListener("click", closeModal);
document.getElementById("modal-backdrop").addEventListener("click", e => {
  if (e.target === e.currentTarget) closeModal();
});
function closeModal() {
  document.getElementById("modal-backdrop").style.display = "none";
  document.body.style.overflow = "";
}

/* ============================================
   üîµ Pages (institution / antifake / report)
   ============================================ */
function renderPages() {
  document.getElementById("institution-display").innerHTML =
    escapeHtml(pages.institution || "").replace(/\n/g, "<br>");

  document.getElementById("antifake-display").innerHTML =
    escapeHtml(pages.antifake || "").replace(/\n/g, "<br>");

  document.getElementById("report-display").innerHTML =
    escapeHtml(pages.report || "").replace(/\n/g, "<br>");
}

/* ============================================
   üîµ START
   ============================================ */
loadData();
</script>
</body>
</html>
