<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>CIC — Center for International Clarity (Student View)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root { --maxw: 1100px; --accent:#b22222; --nav-bg:#f8f8f8; --muted:#666; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial; margin:0; color:#111; background:#fbfbfb;}
    .top-banner { background:var(--accent); color:white; padding:12px; text-align:center; font-weight:700; letter-spacing:0.5px; font-size:15px;}
    header { background:#222; color:#fff; padding:12px 16px; position:sticky; top:0; z-index:40; display:flex; align-items:center; justify-content:space-between; }
    .logo { font-size:20px; font-weight:800; }
    .subtitle { font-size:13px; opacity:0.95; color:#e7e7e7; }
    .container { max-width:var(--maxw); margin:16px auto; padding:0 16px; }

    /* Tabs */
    .tabs { background:var(--nav-bg); border-bottom:1px solid #e6e6e6; display:flex; gap:18px; padding:10px 16px; position:sticky; top:64px; z-index:30; }
    .tab { cursor:pointer; padding:8px 10px; border-radius:4px; font-weight:700; color:#333; }
    .tab.active { background:white; border:1px solid #e6e6e6; box-shadow:0 1px 3px rgba(0,0,0,0.06); }

    /* Layout */
    .pane { display:none; padding-top:18px; }
    .pane.active { display:block; }

    /* Article cards */
    .articles { display:grid; grid-template-columns:1fr; gap:14px; }
    @media(min-width:720px){ .articles{ grid-template-columns:1fr 1fr; } }
    article.card { background:white; padding:14px; border-radius:8px; border:1px solid #eee; box-shadow:0 1px 4px rgba(0,0,0,0.04);}
    article h2 { font-size:18px; cursor:pointer; color:#123a7a; text-decoration:underline; margin:6px 0; }
    .meta { font-size:13px; color:#666; margin-bottom:10px; }
    img.thumb { width:100%; height:220px; object-fit:cover; border-radius:6px; cursor:pointer; }

    /* Modal */
    .modal-backdrop { position:fixed; inset:0; background:rgba(0,0,0,0.65); display:none; align-items:center; justify-content:center; z-index:200; }
    .modal { background:white; width:min(900px,95%); max-height:92vh; overflow:auto; border-radius:8px; padding:18px; box-shadow:0 6px 30px rgba(0,0,0,0.3);}
    .modal h2 { margin-top:0; }

    /* Info page */
    .info-display { background:white; padding:16px; border-radius:8px; border:1px solid #eee; min-height:120px; }
  </style>
</head>
<body>

  <div class="top-banner">CIC — Center for International Clarity</div>

  <header>
    <div>
      <div class="logo">Anti-Fake News Site</div>
      <div class="subtitle">Global News Platform</div>
    </div>
    <div style="min-width:1px;"></div>
  </header>

  <!-- Tabs -->
  <div class="tabs">
    <div class="tab active" data-tab="news">News</div>
    <div class="tab" data-tab="institution">Information of Institution</div>
    <div class="tab" data-tab="antifake">Anti-Fake News System</div>
    <div class="tab" data-tab="report">Report</div>
  </div>

  <div class="container">
    <!-- NEWS -->
    <div id="pane-news" class="pane active">
      <div id="articles" class="articles"></div>
    </div>

    <!-- Institution -->
    <div id="pane-institution" class="pane">
      <h2>Institution Information</h2>
      <div id="institution-display" class="info-display"></div>
    </div>

    <!-- Anti-Fake -->
    <div id="pane-antifake" class="pane">
      <h2>Anti-Fake News System</h2>
      <div id="antifake-display" class="info-display"></div>
    </div>

    <!-- Report -->
    <div id="pane-report" class="pane">
      <h2>Report</h2>
      <div id="report-display" class="info-display"></div>
    </div>
  </div>

  <footer>
    <div style="text-align:center;color:#666;font-size:13px;margin:20px 0;">
      Created for classroom media literacy.
    </div>
  </footer>

  <!-- Modal -->
  <div id="modal-backdrop" class="modal-backdrop">
    <div class="modal">
      <button id="modal-close" style="float:right;background:#eee;border:none;border-radius:6px;padding:6px;cursor:pointer;">✕ Close</button>
      <div id="modal-content"></div>
    </div>
  </div>

<script>
/* ===== TAB switching ===== */
document.querySelectorAll('.tab').forEach(tab=>{
  tab.onclick = ()=>{
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    tab.classList.add('active');

    document.querySelectorAll('.pane').forEach(p=>p.classList.remove('active'));
    document.getElementById('pane-'+tab.dataset.tab).classList.add('active');
    window.scrollTo({top:0,behavior:'smooth'});
  };
});

/* ===== JSON URL ===== */
const JSON_URL =
  "https://raw.githubusercontent.com/qkrrjs146-oss/cicinternational/main/mocknews_export_2025-12-01%20(5).json";

/* ===== Data load ===== */
let articles = [];
let pages = {};

async function loadData(){
  try{
    const res = await fetch(JSON_URL);
    const data = await res.json();
    articles = data.articles || [];
    pages = data.pages || {};
    renderArticles();
    renderPages();
  }catch(e){
    document.getElementById("articles").innerHTML =
      "<p style='color:red;'>Failed to load data.</p>";
  }
}

function escapeHtml(t){
  return t ? t.replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]) : "";
}

/* ===== Articles ===== */
function renderArticles(){
  const box = document.getElementById("articles");
  box.innerHTML = "";
  let sorted = articles.slice().sort((a,b)=>b.savedAt - a.savedAt);

  sorted.forEach(a=>{
    const card = document.createElement("article");
    card.className = "card";

    card.innerHTML = `
      ${a.image ? `<img class="thumb" src="${a.image}" data-id="${a.id}">` : ""}
      <h2 data-id="${a.id}">${escapeHtml(a.title)}</h2>
      <div class="meta">
        ${escapeHtml(a.author||"Unknown")} · 
        ${escapeHtml(a.category||"")} · 
        ${new Date(a.savedAt).toLocaleString()}
      </div>
      <p>${escapeHtml(a.body).slice(0,250)}${a.body.length>250?"...":""}</p>
    `;

    box.appendChild(card);
  });

  document.querySelectorAll(".thumb").forEach(el => el.onclick = ()=>openArticle(el.dataset.id));
  document.querySelectorAll("h2[data-id]").forEach(el => el.onclick = ()=>openArticle(el.dataset.id));
}

/* ===== Modal ===== */
function openArticle(id){
  const a = articles.find(x=>x.id===id);
  if(!a) return;

  const modal = document.getElementById("modal-backdrop");
  const content = document.getElementById("modal-content");

  content.innerHTML = `
    <h2>${escapeHtml(a.title)}</h2>
    <div class="meta">
      ${escapeHtml(a.author||"Unknown")} · 
      ${escapeHtml(a.category||"")} ·
      ${new Date(a.savedAt).toLocaleString()}
    </div>
    ${a.image ? `<img src="${a.image}" style="width:100%;border-radius:8px;margin:10px 0;">`:""}
    <div style="white-space:pre-wrap;">${escapeHtml(a.body)}</div>
  `;
  modal.style.display = "flex";
  document.body.style.overflow = "hidden";
}

document.getElementById("modal-close").onclick = ()=>closeModal();
document.getElementById("modal-backdrop").onclick = e=>{
  if(e.target===e.currentTarget) closeModal();
};
function closeModal(){
  document.getElementById("modal-backdrop").style.display="none";
  document.body.style.overflow="";
}

/* ===== Pages ===== */
function renderPages(){
  document.getElementById("institution-display").innerHTML =
    escapeHtml(pages.institution||"").replace(/\n/g,"<br>");

  document.getElementById("antifake-display").innerHTML =
    escapeHtml(pages.antifake||"").replace(/\n/g,"<br>");

  document.getElementById("report-display").innerHTML =
    escapeHtml(pages.report||"").replace(/\n/g,"<br>");
}

/* ===== Start ===== */
loadData();
</script>
</body>
</html>
